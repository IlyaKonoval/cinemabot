# Telegram Film Finder Bot (deactivated)

Телеграм-бот для поиска фильмов с использованием внешних API и сохранением истории запросов.

## Описание проекта

Этот асинхронный телеграм-бот написан на Python с использованием библиотек `asyncio`, `aiohttp` и `aiogram`. Он позволяет:
- Искать фильмы и сериалы по названию.
- Получать информацию о фильме, такую как название, рейтинг и постер, с помощью [Kinopoisk API](https://api.kinopoisk.dev/).
- Находить ссылки для онлайн-просмотра через [Google Custom Search API](https://developers.google.com/custom-search/).
- Сохранять историю поисковых запросов и подсчитывать статистику запросов пользователей в базе данных SQLite.
- Взаимодействовать с пользователем через интуитивное главное меню и дополнительную клавиатуру для выбора колоды в режиме "Гвинт".

## Особенности

- **Асинхронная обработка:** Использование `asyncio` и `aiohttp` для высокопроизводительных запросов.
- **Интеграция с Telegram:** Работа с Telegram API посредством библиотеки `aiogram`.
- **Внешние API:** Интеграция с Kinopoisk для получения данных о фильмах и Google Custom Search для поиска ссылок.
- **Локальная база данных:** Сохранение истории запросов и статистики по пользователям с помощью SQLite.
- **Интерактивные клавиатуры:** Реализованы два типа клавиатур:
  - Основная клавиатура с кнопками «Поиск фильма», «История» и «Статистика».
  - Клавиатура для выбора колоды в режиме "Гвинт".

## Основные команды

### `/start`
Запускает бота и выводит приветственное сообщение с основным меню.

  ![image](https://github.com/user-attachments/assets/9d3263fa-6dd1-4407-83d4-cfcd607fdc0f)

  
### `/help`
Выводит справочную информацию о командах и функциональности бота.

  ![image](https://github.com/user-attachments/assets/1e3ae5b8-68d9-4e10-86c6-4e00104a2001)

### `/stats`
Показывает статистику поиска для конкретного пользователя.

  ![image](https://github.com/user-attachments/assets/ff72e0b6-f743-4903-8524-cc463f357476)

### `/history`
Отображает историю поисковых запросов пользователя.

  ![image](https://github.com/user-attachments/assets/5f5f837f-a5c5-478b-a3e0-8bafdff2adb3)


## Работа с текстовыми сообщениями

### Поиск фильма
Отправьте название фильма или сериала – бот выполнит поиск, сохранит запрос в базу данных и предоставит информацию о фильме, включая ссылки для просмотра (если они найдены).

### Режим "Гвинт"
При отправке слова **"Гвинт"** бот предложит выбрать одну из колод с помощью интерактивной клавиатуры.

## Взаимодействие с API

### Kinopoisk API
Для поиска информации о фильмах используется Kinopoisk API. Бот корректирует название фильма (если необходимо) и запрашивает данные, такие как название, рейтинг и URL постера.

### Google Custom Search API
Для получения ссылок на онлайн-просмотр фильмов бот выполняет запрос к Google Custom Search API, извлекая первые несколько релевантных результатов.

## Примеры
1. **Venom**
   
   ![image](https://github.com/user-attachments/assets/5cbedc4b-1bb3-4c96-8f5e-d7f7215b8b40)

2. **Остров собак**

   ![image](https://github.com/user-attachments/assets/688a3287-2a79-41f3-9e68-09affa3370b7)

3. **Магия лунного света**

   ![image](https://github.com/user-attachments/assets/f61761e8-af7a-4e71-99e3-fa77ca8ccf5f)

4. **Мстители: война бесконечности**

   ![image](https://github.com/user-attachments/assets/023373bd-aa9c-4e98-a767-f7f54686541c)

5. **Город в котором меня нет**

   ![image](https://github.com/user-attachments/assets/8f546f1c-b1f8-4e1e-84e2-34f42aad8d5f)

6. **как витька чеснок вез леху штыря в дом инвалидов**

   ![image](https://github.com/user-attachments/assets/1e90285d-7ad9-4c7d-8440-99d31eaf87f0)

7. **Гвинт**

   ![image](https://github.com/user-attachments/assets/510cb207-c554-4510-88e4-3965d1ed1c66)








## Установка

1. **Клонируйте репозиторий:**

    ```bash
    git clone https://github.com/yourusername/yourrepository.git
    cd yourrepository
    ```

2. **Установите зависимости:**

    Убедитесь, что у вас установлен Python 3.12 или выше. Затем установите необходимые пакеты:

    ```bash
    pip install -r requirements.txt
    ```

3. **Настройте API ключи и базу данных:**

    Создайте файл `api_file.py` в корне проекта и добавьте в него следующие параметры:

    ```python
    BOT_TOKEN = "YOUR_TELEGRAM_BOT_TOKEN"
    KINOPOISK_API_KEY = "YOUR_KINOPOISK_API_KEY"
    GOOGLE_CX_KEY = "YOUR_GOOGLE_CX_KEY"
    GOOGLE_API_KEY = "YOUR_GOOGLE_API_KEY"
    DATABASE_NAME = "your_database.db"
    ```

## Структура проекта

- **`main.py`**  
  Основной файл, содержащий логику бота: обработку команд, сообщений и callback-запросов.

- **`database.py`**  
  Модуль для работы с SQLite базой данных. Класс `DataBaseHandler` отвечает за сохранение истории поисковых запросов и статистики.

- **`keyboard/`**  
  Каталог с файлами, определяющими клавиатуры:
  - `main_keyboard.py` – основное меню для поиска, истории и статистики.
  - `deck_keyboard.py` – клавиатура для выбора колоды (режим "Гвинт").

- **`api_file.py`**  
  Файл с настройками, содержащий API ключи и название базы данных.

## Использование

### Запуск бота

Запустите бота командой:

```bash
python main.py
```
## Лицензия
  `Этот проект распространяется под лицензией MIT License.`
